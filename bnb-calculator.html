<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BNB投资计算器 | Binance风格</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        binance: {
                            blue: '#0F172A', // 币安深色背景
                            lightBlue: '#1E40AF', // 币安亮蓝色
                            primary: '#F3BA2F', // 币安黄色
                            secondary: '#2563EB', // 币安次要蓝色
                            dark: '#0B1120', // 币安更深色
                            card: '#1E293B', // 卡片背景
                            text: '#F8FAFC', // 主要文本
                            textLight: '#94A3B8', // 次要文本
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .binance-shadow {
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            }
            .hover-lift {
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            .hover-lift:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
            }
            .pulse-update {
                animation: pulse 0.5s ease-in-out;
            }
            @keyframes pulse {
                0% { background-color: rgba(243, 186, 47, 0.1); }
                100% { background-color: transparent; }
            }
            .loading-bar {
                position: relative;
                overflow: hidden;
            }
            .loading-bar::after {
                content: "";
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
                animation: loading 1.5s infinite;
            }
            @keyframes loading {
                100% { left: 100%; }
            }
        }
    </style>
</head>
<body class="bg-binance-blue text-binance-text font-sans min-h-screen">
    <!-- 顶部导航栏 - 币安风格 -->
    <header class="bg-binance-dark border-b border-gray-800 sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <i class="fa fa-btc text-binance-primary text-2xl mr-2"></i>
                        <span class="font-bold text-xl">Binance BNB Calculator</span>
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="flex items-center space-x-4">
                        <span id="header-time" class="text-binance-textLight text-sm"></span>
                        <button id="theme-toggle" class="p-2 rounded-md hover:bg-gray-700 transition-colors">
                            <i class="fa fa-moon-o"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="container mx-auto px-4 py-8">
        <!-- 页面标题 -->
        <div class="mb-8">
            <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold">BNB投资计算器</h1>
            <p class="text-binance-textLight mt-2">实时计算BNB的USDT及人民币价值</p>
        </div>

        <!-- 价格概览卡片 -->
        <div class="bg-binance-card rounded-xl p-6 mb-8 binance-shadow">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                <h2 class="text-xl font-semibold">BNB 价格概览</h2>
                <div class="flex items-center mt-4 md:mt-0">
                    <span id="last-updated" class="text-binance-textLight text-sm mr-4">最后更新: 加载中...</span>
                    <button id="refresh-btn" class="bg-binance-primary hover:bg-opacity-90 text-binance-dark px-4 py-2 rounded-lg font-medium transition-colors flex items-center">
                        <i class="fa fa-refresh mr-2"></i>
                        刷新
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-binance-dark rounded-lg p-5 loading-bar" id="bnb-price-card">
                    <div class="text-binance-textLight text-sm mb-1">BNB / USDT</div>
                    <div class="flex items-baseline">
                        <span id="bnb-usdt-price" class="text-2xl md:text-3xl font-bold">--</span>
                        <span class="ml-2 text-green-400 text-sm" id="bnb-change">0.00%</span>
                    </div>
                </div>

                <div class="bg-binance-dark rounded-lg p-5 loading-bar" id="cny-price-card">
                    <div class="text-binance-textLight text-sm mb-1">BNB / CNY</div>
                    <div class="text-2xl md:text-3xl font-bold" id="bnb-cny-price">--</div>
                </div>

                <div class="bg-binance-dark rounded-lg p-5 loading-bar" id="rate-card">
                    <div class="text-binance-textLight text-sm mb-1">1 USDT = CNY</div>
                    <div class="text-2xl md:text-3xl font-bold" id="usdt-cny-rate">--</div>
                    <div class="text-xs text-binance-textLight mt-2">汇率来源: ExchangeRate-API</div>
                </div>
            </div>
        </div>

        <!-- 计算结果区域 -->
        <div class="mb-6">
            <h2 class="text-xl font-semibold mb-4">常用数量换算</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
                <!-- 0.03 BNB -->
                <div class="bg-binance-card rounded-lg p-5 binance-shadow hover-lift">
                    <div class="text-binance-textLight text-sm mb-2">0.03 BNB</div>
                    <div class="text-lg font-bold mb-1" id="0.03-usdt">--</div>
                    <div class="text-sm text-binance-textLight" id="0.03-cny">--</div>
                </div>

                <!-- 0.05 BNB -->
                <div class="bg-binance-card rounded-lg p-5 binance-shadow hover-lift">
                    <div class="text-binance-textLight text-sm mb-2">0.05 BNB</div>
                    <div class="text-lg font-bold mb-1" id="0.05-usdt">--</div>
                    <div class="text-sm text-binance-textLight" id="0.05-cny">--</div>
                </div>

                <!-- 0.1 BNB -->
                <div class="bg-binance-card rounded-lg p-5 binance-shadow hover-lift">
                    <div class="text-binance-textLight text-sm mb-2">0.1 BNB</div>
                    <div class="text-lg font-bold mb-1" id="0.1-usdt">--</div>
                    <div class="text-sm text-binance-textLight" id="0.1-cny">--</div>
                </div>

                <!-- 0.2 BNB -->
                <div class="bg-binance-card rounded-lg p-5 binance-shadow hover-lift">
                    <div class="text-binance-textLight text-sm mb-2">0.2 BNB</div>
                    <div class="text-lg font-bold mb-1" id="0.2-usdt">--</div>
                    <div class="text-sm text-binance-textLight" id="0.2-cny">--</div>
                </div>

                <!-- 0.5 BNB -->
                <div class="bg-binance-card rounded-lg p-5 binance-shadow hover-lift">
                    <div class="text-binance-textLight text-sm mb-2">0.5 BNB</div>
                    <div class="text-lg font-bold mb-1" id="0.5-usdt">--</div>
                    <div class="text-sm text-binance-textLight" id="0.5-cny">--</div>
                </div>
            </div>
        </div>

        <!-- 自定义计算器 -->
        <div class="bg-binance-card rounded-xl p-6 mb-8 binance-shadow">
            <h2 class="text-xl font-semibold mb-6">自定义计算</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label class="block text-binance-textLight text-sm mb-2">BNB数量</label>
                    <div class="relative">
                        <input type="number" id="custom-amount" step="0.001" min="0" 
                               class="w-full bg-binance-dark border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-binance-primary text-white"
                               placeholder="输入BNB数量">
                        <div class="absolute right-3 top-1/2 -translate-y-1/2 text-binance-textLight">BNB</div>
                    </div>
                </div>
                <div class="md:col-span-2 flex items-end">
                    <button id="calculate-custom" class="w-full bg-binance-secondary hover:bg-opacity-90 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                        计算价值
                    </button>
                </div>
            </div>

            <div id="custom-result" class="mt-6 hidden">
                <div class="bg-binance-dark rounded-lg p-5">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <div class="text-binance-textLight text-sm mb-1">USDT 价值</div>
                            <div class="text-2xl font-bold" id="custom-usdt">--</div>
                        </div>
                        <div>
                            <div class="text-binance-textLight text-sm mb-1">CNY 价值</div>
                            <div class="text-2xl font-bold" id="custom-cny">--</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 免责声明 -->
        <div class="bg-amber-900/30 border border-amber-800/50 rounded-lg p-4 text-sm">
            <div class="flex">
                <i class="fa fa-exclamation-triangle text-amber-400 mt-0.5 mr-3"></i>
                <div>
                    <p class="font-medium text-amber-300">免责声明</p>
                    <p class="text-amber-200/80 mt-1">
                        本工具提供的所有数据仅供参考，不构成任何投资建议。加密货币价格波动较大，请谨慎投资。
                        数据来源于币安交易所和公开汇率API，可能存在延迟。
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-binance-dark border-t border-gray-800 mt-12 py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <i class="fa fa-btc text-binance-primary text-xl mr-2"></i>
                    <span class="font-medium">BNB投资计算器</span>
                </div>
                <div class="text-binance-textLight text-sm">
                    © 2023 仅供教育用途 | 数据延迟可能存在
                </div>
            </div>
        </div>
    </footer>

    <script>
        // 全局变量
        let usdtToCnyRate = 0;
        let bnbUsdtPrice = 0;
        let lastBnbPrice = 0;
        const bnbAmounts = [0.03, 0.05, 0.1, 0.2, 0.5];
        
        // 更新页面时间
        function updateHeaderTime() {
            const now = new Date();
            document.getElementById('header-time').textContent = now.toLocaleString();
        }
        
        // 初始更新时间并设置定时器
        updateHeaderTime();
        setInterval(updateHeaderTime, 60000);
        
        // 获取实时汇率 (USDT to CNY)
        async function getUsdtToCnyRate() {
            try {
                const response = await fetch('https://open.er-api.com/v6/latest/USD');
                const data = await response.json();
                
                if (data.rates && data.rates.CNY) {
                    usdtToCnyRate = data.rates.CNY;
                    document.getElementById('usdt-cny-rate').textContent = usdtToCnyRate.toFixed(2);
                    return true;
                } else {
                    throw new Error('无法获取汇率数据');
                }
            } catch (error) {
                console.error('获取汇率失败:', error);
                usdtToCnyRate = 7.20;
                document.getElementById('usdt-cny-rate').textContent = `${usdtToCnyRate.toFixed(2)} (默认)`;
                return false;
            } finally {
                document.getElementById('rate-card').classList.remove('loading-bar');
            }
        }
        
        // 获取BNB价格变化百分比
        async function getBnbPriceChange() {
            try {
                const response = await fetch('https://api.binance.com/api/v3/ticker/24hr?symbol=BNBUSDT');
                const data = await response.json();
                return data.priceChangePercent || 0;
            } catch (error) {
                console.error('获取价格变化失败:', error);
                return 0;
            }
        }
        
        // 获取BNB价格并计算所有数值
        async function updateBnbPrices() {
            // 显示加载状态
            document.getElementById('bnb-price-card').classList.add('loading-bar');
            document.getElementById('cny-price-card').classList.add('loading-bar');
            bnbAmounts.forEach(amount => {
                document.getElementById(`${amount}-usdt`).textContent = '加载中...';
                document.getElementById(`${amount}-cny`).textContent = '加载中...';
            });
            
            try {
                // 先确保获取到汇率
                if (usdtToCnyRate === 0) {
                    await getUsdtToCnyRate();
                }
                
                // 获取BNB价格变化
                const priceChange = await getBnbPriceChange();
                const changeElement = document.getElementById('bnb-change');
                changeElement.textContent = `${parseFloat(priceChange).toFixed(2)}%`;
                
                // 设置涨跌颜色
                if (parseFloat(priceChange) >= 0) {
                    changeElement.className = 'ml-2 text-green-400 text-sm';
                    changeElement.innerHTML = `<i class="fa fa-caret-up"></i> ${parseFloat(priceChange).toFixed(2)}%`;
                } else {
                    changeElement.className = 'ml-2 text-red-400 text-sm';
                    changeElement.innerHTML = `<i class="fa fa-caret-down"></i> ${parseFloat(priceChange).toFixed(2)}%`;
                }
                
                // 从币安API获取BNB/USDT价格
                const response = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BNBUSDT');
                const data = await response.json();
                
                if (data.price) {
                    lastBnbPrice = bnbUsdtPrice;
                    bnbUsdtPrice = parseFloat(data.price);
                    
                    // 更新1 BNB的价格显示
                    document.getElementById('bnb-usdt-price').textContent = bnbUsdtPrice.toFixed(2);
                    
                    // 计算人民币价格
                    const bnbCnyPrice = bnbUsdtPrice * usdtToCnyRate;
                    document.getElementById('bnb-cny-price').textContent = bnbCnyPrice.toFixed(2);
                    
                    // 如果价格有变化，添加动画效果
                    if (lastBnbPrice !== 0 && lastBnbPrice !== bnbUsdtPrice) {
                        document.getElementById('bnb-price-card').classList.add('pulse-update');
                        setTimeout(() => {
                            document.getElementById('bnb-price-card').classList.remove('pulse-update');
                        }, 500);
                    }
                    
                    // 计算并更新各个数量的价值
                    bnbAmounts.forEach(amount => {
                        const usdtValue = amount * bnbUsdtPrice;
                        const cnyValue = usdtValue * usdtToCnyRate;
                        
                        document.getElementById(`${amount}-usdt`).textContent = `${usdtValue.toFixed(2)} USDT`;
                        document.getElementById(`${amount}-cny`).textContent = `${cnyValue.toFixed(2)} CNY`;
                    });
                    
                    // 更新时间戳
                    const now = new Date();
                    document.getElementById('last-updated').textContent = `最后更新: ${now.toLocaleString()}`;
                } else {
                    throw new Error('无法获取BNB价格数据');
                }
            } catch (error) {
                console.error('获取BNB价格失败:', error);
                document.getElementById('bnb-usdt-price').textContent = '获取失败';
                document.getElementById('bnb-cny-price').textContent = '获取失败';
                bnbAmounts.forEach(amount => {
                    document.getElementById(`${amount}-usdt`).textContent = '获取失败';
                    document.getElementById(`${amount}-cny`).textContent = '获取失败';
                });
            } finally {
                document.getElementById('bnb-price-card').classList.remove('loading-bar');
                document.getElementById('cny-price-card').classList.remove('loading-bar');
            }
        }
        
        // 自定义计算
        function calculateCustom() {
            const amountInput = document.getElementById('custom-amount');
            const amount = parseFloat(amountInput.value);
            
            if (isNaN(amount) || amount <= 0) {
                alert('请输入有效的BNB数量');
                return;
            }
            
            if (bnbUsdtPrice === 0) {
                alert('请先等待价格数据加载完成');
                return;
            }
            
            // 计算价值
            const usdtValue = amount * bnbUsdtPrice;
            const cnyValue = usdtValue * usdtToCnyRate;
            
            // 显示结果
            document.getElementById('custom-usdt').textContent = `${usdtValue.toFixed(2)} USDT`;
            document.getElementById('custom-cny').textContent = `${cnyValue.toFixed(2)} CNY`;
            document.getElementById('custom-result').classList.remove('hidden');
        }
        
        // 页面加载时初始化
        window.addEventListener('DOMContentLoaded', async () => {
            await getUsdtToCnyRate();
            await updateBnbPrices();
            
            // 每5分钟自动更新一次数据
            setInterval(async () => {
                await getUsdtToCnyRate();
                await updateBnbPrices();
            }, 300000); // 300000毫秒 = 5分钟
            
            // 绑定事件
            document.getElementById('refresh-btn').addEventListener('click', async () => {
                await getUsdtToCnyRate();
                await updateBnbPrices();
            });
            
            document.getElementById('calculate-custom').addEventListener('click', calculateCustom);
            
            document.getElementById('custom-amount').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    calculateCustom();
                }
            });
        });
    </script>
</body>
</html>
